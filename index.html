<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Library of Important Jazz Musicians</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fff;
      color: #000;
      margin: 20px;
    }
    h1 {
      color: #8b1453;
      text-align: center;
    }
    .filters {
      margin-bottom: 20px;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    select {
      padding: 5px;
    }
    .musician {
      border: 1px solid #ddd;
      padding: 15px;
      margin-bottom: 10px;
      border-radius: 8px;
    }
    .musician h2 {
      margin: 0;
      color: #8b1453;
    }
    .spotify a {
      color: #8b1453;
    }
  </style>
</head>
<body>

<h1>Library of Important Jazz Musicians</h1>

<div class="filters">
  <select id="eraFilter">
    <option value="">Filter by Era</option>
  </select>
  <select id="instrumentFilter">
    <option value="">Filter by Instrument/Role</option>
  </select>
  <select id="genreFilter">
    <option value="">Filter by Genre/Style</option>
  </select>
</div>

<div id="musicians"></div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script>
  async function loadCSV() {
    const response = await fetch('data/important_jazz_musicians_batch_1.csv');
    const csvText = await response.text();

    Papa.parse(csvText, {
      header: true,
      skipEmptyLines: true,
      complete: function(results) {
        const data = results.data;
        displayMusicians(data);
        populateFilters(data);
      }
    });
  }

  function displayMusicians(data) {
    const container = document.getElementById('musicians');
    container.innerHTML = '';
    data.forEach(musician => {
      if (
        filterMatch(musician.Era, 'eraFilter') &&
        filterMatch(musician['Instrument/Role'], 'instrumentFilter') &&
        filterMatch(musician['Genre/Style'], 'genreFilter')
      ) {
        const div = document.createElement('div');
        div.className = 'musician';
        div.innerHTML = `
          <h2>${musician.Name}</h2>
          <p><strong>Instrument/Role:</strong> ${musician['Instrument/Role']}</p>
          <p><strong>Genre/Style:</strong> ${musician['Genre/Style']}</p>
          <p><strong>Era:</strong> ${musician.Era}</p>
          <p>${musician.Description}</p>
          <p><strong>Notable Recordings:</strong> ${musician['Notable Recordings']}</p>
          ${musician['Spotify Link'] ? `<p class="spotify"><a href="${musician['Spotify Link']}" target="_blank">Listen on Spotify</a></p>` : ''}
        `;
        container.appendChild(div);
      }
    });
  }

  function populateFilters(data) {
    const eras = new Set();
    const instruments = new Set();
    const genres = new Set();

    data.forEach(musician => {
      if (musician.Era) eras.add(musician.Era);
      if (musician['Instrument/Role']) instruments.add(musician['Instrument/Role']);
      if (musician['Genre/Style']) genres.add(musician['Genre/Style']);
    });

    populateFilter('eraFilter', eras);
    populateFilter('instrumentFilter', instruments);
    populateFilter('genreFilter', genres);

    document.getElementById('eraFilter').addEventListener('change', () => displayMusicians(data));
    document.getElementById('instrumentFilter').addEventListener('change', () => displayMusicians(data));
    document.getElementById('genreFilter').addEventListener('change', () => displayMusicians(data));
  }

  function populateFilter(id, values) {
    const select = document.getElementById(id);
    Array.from(values).sort().forEach(value => {
      const option = document.createElement('option');
      option.value = value;
      option.textContent = value;
      select.appendChild(option);
    });
  }

  function filterMatch(value, filterId) {
    const filter = document.getElementById(filterId).value;
    return !filter || value === filter;
  }

  loadCSV();
</script>

</body>
</html>
